<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ CreatÃ­metro Digital - Viaje al Futuro</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸš€ Viaje al Futuro â€“ El Mundo en 50 AÃ±os</h1>
            <p class="description">
                ğŸŒŸ Bienvenido al <strong>CreatÃ­metro Digital</strong>. Vamos a medir y desarrollar tu creatividad 
                imaginando cÃ³mo serÃ¡ la tecnologÃ­a en 50 aÃ±os. Tienes <strong>5 minutos</strong> para ser tan original como puedas.
            </p>
            <div class="challenge">
                ğŸ§ ğŸ’¡ <strong>Tu reto:</strong> Imagina y escribe todas las ideas tecnolÃ³gicas creativas e innovadoras 
                que crees existirÃ¡n en el aÃ±o 2075. Â¡Piensa sin lÃ­mites!
            </div>
        </header>

        <!-- Timer -->
        <div class="timer-container">
            <div class="timer" id="timer">
                <div class="timer-circle">
                    <div class="timer-text">
                        <span id="minutes">05</span>:<span id="seconds">00</span>
                    </div>
                </div>
            </div>
            <p class="timer-label">â° Tiempo restante</p>
        </div>

        <form id="creativityForm" class="form">
            <!-- SecciÃ³n 1: Datos del estudiante -->
            <section class="form-section">
                <h2>ğŸ“Œ SecciÃ³n 1: Datos rÃ¡pidos sobre ti</h2>
                <div class="input-group">
                    <label for="nombre">ğŸ‘¤ Nombre completo *</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="input-group">
                    <label for="correo">ğŸ“§ Correo institucional *</label>
                    <input type="email" id="correo" name="correo" required>
                </div>
            </section>

            <!-- SecciÃ³n 2: Ideas tecnolÃ³gicas -->
            <section class="form-section">
                <h2>ğŸ“Œ SecciÃ³n 2: Tus ideas tecnolÃ³gicas innovadoras</h2>
                <div class="ideas-grid">
                    <div class="input-group">
                        <label for="idea1">ğŸš€ Idea Innovadora #1:</label>
                        <input type="text" id="idea1" name="idea1" placeholder="Escribe tu primera idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea2">ğŸš€ Idea Innovadora #2:</label>
                        <input type="text" id="idea2" name="idea2" placeholder="Escribe tu segunda idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea3">ğŸš€ Idea Innovadora #3:</label>
                        <input type="text" id="idea3" name="idea3" placeholder="Escribe tu tercera idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea4">ğŸš€ Idea Innovadora #4:</label>
                        <input type="text" id="idea4" name="idea4" placeholder="Escribe tu cuarta idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea5">ğŸš€ Idea Innovadora #5:</label>
                        <input type="text" id="idea5" name="idea5" placeholder="Escribe tu quinta idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea6">ğŸš€ Idea Innovadora #6:</label>
                        <input type="text" id="idea6" name="idea6" placeholder="Escribe tu sexta idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea7">ğŸš€ Idea Innovadora #7:</label>
                        <input type="text" id="idea7" name="idea7" placeholder="Escribe tu sÃ©ptima idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea8">ğŸš€ Idea Innovadora #8:</label>
                        <input type="text" id="idea8" name="idea8" placeholder="Escribe tu octava idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea9">ğŸš€ Idea Innovadora #9:</label>
                        <input type="text" id="idea9" name="idea9" placeholder="Escribe tu novena idea tecnolÃ³gica...">
                    </div>
                    <div class="input-group">
                        <label for="idea10">ğŸš€ Idea Innovadora #10:</label>
                        <input type="text" id="idea10" name="idea10" placeholder="Escribe tu dÃ©cima idea tecnolÃ³gica...">
                    </div>
                </div>
            </section>

            <!-- SecciÃ³n 3: Experiencia -->
            <section class="form-section">
                <h2>ğŸ“Œ SecciÃ³n 3: CuÃ©ntanos sobre tu experiencia</h2>
                
                <div class="input-group">
                    <label>ğŸ‰ Â¿QuÃ© tan divertida encontraste esta actividad?</label>
                    <div class="scale-group">
                        <input type="radio" id="diversion1" name="diversion" value="1">
                        <label for="diversion1">1 - Aburrida</label>
                        <input type="radio" id="diversion2" name="diversion" value="2">
                        <label for="diversion2">2 - Poco divertida</label>
                        <input type="radio" id="diversion3" name="diversion" value="3">
                        <label for="diversion3">3 - Regular</label>
                        <input type="radio" id="diversion4" name="diversion" value="4">
                        <label for="diversion4">4 - Divertida</label>
                        <input type="radio" id="diversion5" name="diversion" value="5">
                        <label for="diversion5">5 - Muy divertida</label>
                    </div>
                </div>

                <div class="input-group">
                    <label>ğŸ§© Â¿QuÃ© tan desafiante fue generar estas ideas?</label>
                    <div class="scale-group">
                        <input type="radio" id="desafio1" name="desafio" value="1">
                        <label for="desafio1">1 - Muy fÃ¡cil</label>
                        <input type="radio" id="desafio2" name="desafio" value="2">
                        <label for="desafio2">2 - FÃ¡cil</label>
                        <input type="radio" id="desafio3" name="desafio" value="3">
                        <label for="desafio3">3 - Regular</label>
                        <input type="radio" id="desafio4" name="desafio" value="4">
                        <label for="desafio4">4 - Desafiante</label>
                        <input type="radio" id="desafio5" name="desafio" value="5">
                        <label for="desafio5">5 - Muy desafiante</label>
                    </div>
                </div>

                <div class="input-group">
                    <label>ğŸ”„ Â¿Te gustarÃ­a participar en mÃ¡s actividades creativas como esta en tus clases?</label>
                    <div class="radio-group">
                        <input type="radio" id="masActividadesSi" name="masActividades" value="si">
                        <label for="masActividadesSi">SÃ­</label>
                        <input type="radio" id="masActividadesNo" name="masActividades" value="no">
                        <label for="masActividadesNo">No</label>
                        <input type="radio" id="masActividadesQuizas" name="masActividades" value="quizas">
                        <label for="masActividadesQuizas">QuizÃ¡s</label>
                    </div>
                </div>

                <div class="input-group">
                    <label for="comentarios">âœï¸ Comentarios o sugerencias para futuras actividades</label>
                    <textarea id="comentarios" name="comentarios" rows="4" placeholder="Comparte tus comentarios o sugerencias (opcional)..."></textarea>
                </div>
            </section>

            <div class="submit-section">
                <button type="submit" id="submitBtn" class="submit-btn">
                    ğŸš€ Enviar mis ideas creativas
                </button>
            </div>
        </form>

        <!-- Mensaje de resultado -->
        <div id="resultMessage" class="result-message" style="display: none;"></div>
    </div>

    <script>
        // Variables globales
        let timeLeft = 300; // 5 minutos en segundos
        let timerInterval;
        let timerStarted = false;
        let startTime;

        // Elementos del DOM
        const timerElement = document.getElementById('timer');
        const minutesElement = document.getElementById('minutes');
        const secondsElement = document.getElementById('seconds');
        const form = document.getElementById('creativityForm');
        const submitBtn = document.getElementById('submitBtn');
        const resultMessage = document.getElementById('resultMessage');

        // FunciÃ³n para iniciar el timer
        function startTimer() {
            if (timerStarted) return;
            
            timerStarted = true;
            startTime = Date.now();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                // Cambiar color cuando queden 60 segundos
                if (timeLeft <= 60) {
                    timerElement.classList.add('warning');
                }
                
                // Tiempo agotado
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerElement.classList.add('expired');
                    alert('â° Â¡Tiempo agotado! El formulario se enviarÃ¡ automÃ¡ticamente.');
                    submitForm();
                }
            }, 1000);
        }

        // FunciÃ³n para actualizar la visualizaciÃ³n del timer
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            minutesElement.textContent = minutes.toString().padStart(2, '0');
            secondsElement.textContent = seconds.toString().padStart(2, '0');
        }

        // Iniciar timer cuando el usuario comience a escribir
        const inputs = form.querySelectorAll('input, textarea');
        inputs.forEach(input => {
            input.addEventListener('focus', startTimer, { once: true });
        });

        // FunciÃ³n para enviar el formulario
        async function submitForm() {
            try {
                // Recopilar datos del formulario
                const formData = new FormData(form);
                const data = {
                    nombre: formData.get('nombre'),
                    correo: formData.get('correo'),
                    ideas: [
                        formData.get('idea1') || '',
                        formData.get('idea2') || '',
                        formData.get('idea3') || '',
                        formData.get('idea4') || '',
                        formData.get('idea5') || '',
                        formData.get('idea6') || '',
                        formData.get('idea7') || '',
                        formData.get('idea8') || '',
                        formData.get('idea9') || '',
                        formData.get('idea10') || ''
                    ],
                    diversion: formData.get('diversion'),
                    desafio: formData.get('desafio'),
                    masActividades: formData.get('masActividades'),
                    comentarios: formData.get('comentarios') || '',
                    tiempoUtilizado: startTime ? Math.floor((Date.now() - startTime) / 1000) : 0
                };

                // Validar datos requeridos
                if (!data.nombre || !data.correo) {
                    showMessage('âŒ Por favor, completa tu nombre y correo.', 'error');
                    return;
                }

                // Deshabilitar botÃ³n de envÃ­o
                submitBtn.disabled = true;
                submitBtn.textContent = 'ğŸ“¤ Enviando...';

                // Enviar datos al servidor
                const response = await fetch('/api/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    showMessage(`âœ… Â¡Gracias ${data.nombre}! Tus ideas han sido enviadas exitosamente. 
                               MÃ©tricas calculadas: Fluidez: ${result.metricas.fluidez}/10, 
                               Flexibilidad: ${result.metricas.flexibilidad}, 
                               Puntaje de Creatividad: ${result.metricas.puntajeCreatividad}/100`, 'success');
                    
                    // Limpiar formulario
                    form.reset();
                    
                    // Detener timer
                    if (timerInterval) {
                        clearInterval(timerInterval);
                    }
                } else {
                    showMessage(`âŒ Error: ${result.message}`, 'error');
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ğŸš€ Enviar mis ideas creativas';
                }

            } catch (error) {
                console.error('Error:', error);
                showMessage('âŒ Error de conexiÃ³n. Por favor, intenta nuevamente.', 'error');
                submitBtn.disabled = false;
                submitBtn.textContent = 'ğŸš€ Enviar mis ideas creativas';
            }
        }

        // FunciÃ³n para mostrar mensajes
        function showMessage(message, type) {
            resultMessage.innerHTML = message;
            resultMessage.className = `result-message ${type}`;
            resultMessage.style.display = 'block';
            
            // Scroll hacia el mensaje
            resultMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Ocultar mensaje despuÃ©s de 10 segundos si es de Ã©xito
            if (type === 'success') {
                setTimeout(() => {
                    resultMessage.style.display = 'none';
                }, 10000);
            }
        }

        // Manejar envÃ­o del formulario
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            submitForm();
        });

        // Prevenir envÃ­o accidental con Enter
        form.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
            }
        });

        // InicializaciÃ³n
        updateTimerDisplay();
    </script>
</body>
</html>
